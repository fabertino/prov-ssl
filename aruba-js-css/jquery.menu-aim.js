(function(e){function t(t){var n=e(this),r=null,i=[],s=null,o=null,u=e.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:e.noop,exit:e.noop,activate:e.noop,deactivate:e.noop,exitMenu:e.noop},t);var a=3,f=300;var l=function(e){i.push({x:e.pageX,y:e.pageY});if(i.length>a){i.shift()}};var c=function(){if(o){clearTimeout(o)}if(u.exitMenu(this)){if(r){u.deactivate(r)}r=null}};var h=function(){if(o){clearTimeout(o)}u.enter(this);m(this)},p=function(){u.exit(this)};var d=function(){v(this)};var v=function(e){if(e==r){return}if(r){u.deactivate(r)}u.activate(e);r=e};var m=function(e){var t=g();if(t){o=setTimeout(function(){m(e)},t)}else{v(e)}};var g=function(){function d(e,t){return(t.y-e.y)/(t.x-e.x)}if(!r||!e(r).is(u.submenuSelector)){return 0}var t=n.offset(),o={x:t.left,y:t.top-u.tolerance},a={x:t.left+n.outerWidth(),y:o.y},l={x:t.left,y:t.top+n.outerHeight()+u.tolerance},c={x:t.left+n.outerWidth(),y:l.y},h=i[i.length-1],p=i[0];if(!h){return 0}if(!p){p=h}if(p.x<t.left||p.x>c.x||p.y<t.top||p.y>c.y){return 0}if(s&&h.x==s.x&&h.y==s.y){return 0}var v=a,m=c;if(u.submenuDirection=="left"){v=l;m=o}else if(u.submenuDirection=="below"){v=c;m=l}else if(u.submenuDirection=="above"){v=o;m=a}var g=d(h,v),y=d(h,m),b=d(p,v),w=d(p,m);if(g<b&&y>w){s=h;return f}s=null;return 0};n.mouseleave(c).find(u.rowSelector).mouseenter(h).mouseleave(p).click(d);e(document).mousemove(l)}e.fn.menuAim=function(e){this.each(function(){t.call(this,e)});return this};})(jQuery)